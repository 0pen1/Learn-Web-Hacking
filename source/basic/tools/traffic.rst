流量相关
================================

TCPDump
--------------------------------
TCPDump是一款数据包的抓取分析工具，可以将网络中传送的数据包的完全截获下来提供分析。它支持针对网络层、协议、主机、网络或端口的过滤，并提供逻辑语句来过滤包。

命令行常用选项
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
- ``-B <buffer_size>`` 抓取流量的缓冲区大小，若过小则可能丢包，单位为KB
- ``-c <count>`` 抓取n个包后退出
- ``-C <file_size>`` 当前记录的包超过一定大小后，另起一个文件记录，单位为MB
- ``-i <interface>`` 指定抓取网卡经过的流量
- ``-n`` 不转换地址
- ``-r <file>`` 读取保存的pcap文件
- ``-s <snaplen>`` 从每个报文中截取snaplen字节的数据，0为所有数据
- ``-W <cnt>`` 写满cnt个文件后就不再写入
- ``-w <file>`` 保存流量至文件
- ``-Z <user>`` 在写文件之前，转换用户

Bro
--------------------------------
Bro是一个开源的网络流量分析工具，支持多种协议，可实时或者离线分析流量。

命令行
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
- 实时监控 ``bro -i <interface> <list of script to load>``
- 分析本地流量 ``bro -r <pcapfile> <scripts...>``
- 分割解析流量后的日志 ``bro-cut``

脚本
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
为了能够扩展和定制Bro的功能，Bro提供了一个事件驱动的脚本语言。


tcpflow
--------------------------------
tcpflow也是一个抓包工具，它的特点是以流为单位显示数据内容，在分析HTTP等协议的数据时候，用tcpflow会更便捷。

命令行常用选项
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
- ``-b max_bytes`` 定义最大抓取流量
- ``-e name`` 指定解析的scanner
- ``-i interface`` 指定抓取接口
- ``-o outputdir`` 指定输出文件夹
- ``-r file`` 读取文件
- ``-R file`` 读取文件，但是只读取完整的文件
